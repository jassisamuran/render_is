{"ast":null,"code":"import axios from'axios';import React,{useState,useEffect}from'react';import{Link,redirect,useNavigate}from'react-router-dom';import{Form,Row,Col,Button,NavItem,File}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import{useParams}from'react-router';import Loader from'../components/Loader';import Message from'../components/Message';import FormContainer from'../components/FormContainer';import{listProductDetails,updateProduct}from'../actions/productActions';import{PRODUCT_UPDATE_RESET}from'../constants/productConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ProductEditScreen=_ref=>{let{}=_ref;const navigate=useNavigate();const dispatch=useDispatch();const{id}=useParams();// console.log(id)\nconst[name,setName]=useState('');const[price,setPrice]=useState('');const[image,setImage]=useState('');const[brand,setBrand]=useState('');const[category,setCategory]=useState('');const[countInStock,setCountInStock]=useState('');const[description,setDescription]=useState('');const[uploading,setUploading]=useState(false);const productDetails=useSelector(state=>state.productDetails);const{loading,error,product}=productDetails;const productUpdate=useSelector(state=>state.productUpdate);const{loading:loadingUpdate,error:errorUpdate,success:successUpdate}=productUpdate;// console.log(successUpdate)\nuseEffect(()=>{if(successUpdate){console.log('called');dispatch({type:PRODUCT_UPDATE_RESET});navigate('/admin/productlist');}else{if(!product.name||product._id!==id){dispatch(listProductDetails(id));}else{// console.log('this is st data')\n// console.log(product.name)\nsetName(product.name);setPrice(product.price);setDescription(product.description);setBrand(product.brand);setCategory(product.category);setCountInStock(product.countInStock);setImage(product.image);}}},[dispatch,id,navigate,product,successUpdate]);const handleChange=async e=>{const file=e.target.files[0];// setImage(e.target.files[0])\nconst formData=new FormData();formData.append('image',file);console.log(formData);setUploading(true);try{const config={headers:{'Content-Type':'mutipart/form-data'}};const{data}=await axios.post('/api/upload',formData,config);setImage(data);setUploading(false);}catch(err){console.log(err);setUploading(false);}};const submitHandler=e=>{e.preventDefault();dispatch(updateProduct({_id:id,name,price,description,image,brand,category,countInStock}));};const setPassword=()=>{console.log('set password');};//   function handleChange(e) {\n//     console.log(e.target.files);\n//     setImage(URL.createObjectURL(e.target.files[0]));\n// }\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/admin/productlist\",className:\"btn btn-light my-3\",children:\"Go back\"}),/*#__PURE__*/_jsxs(FormContainer,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Edit Product\"}),errorUpdate&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorUpdate}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"name\",placeholder:\"Enter name\",value:name,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter Price\",value:price,onChange:e=>setPrice(e.target.value)})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(\"img\",{src:image}),uploading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"brand\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Brand \"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",label:\"Enter brand\",value:brand,onChange:e=>setBrand(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"countInStock\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Count In Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Enter countInStock\",value:countInStock,onChange:e=>setCountInStock(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"category\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category \"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",label:\"Enter category\",value:category,onChange:e=>setCategory(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description \"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",label:\"Enter description\",value:description,onChange:e=>setDescription(e.target.value)})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"submit\"})]})]})]});};export default ProductEditScreen;","map":{"version":3,"names":["axios","React","useState","useEffect","Link","redirect","useNavigate","Form","Row","Col","Button","NavItem","File","useDispatch","useSelector","useParams","Loader","Message","FormContainer","listProductDetails","updateProduct","PRODUCT_UPDATE_RESET","ProductEditScreen","navigate","dispatch","id","name","setName","price","setPrice","image","setImage","brand","setBrand","category","setCategory","countInStock","setCountInStock","description","setDescription","uploading","setUploading","productDetails","state","loading","error","product","productUpdate","loadingUpdate","errorUpdate","success","successUpdate","console","log","type","_id","handleChange","e","file","target","files","formData","FormData","append","config","headers","data","post","err","submitHandler","preventDefault","setPassword","value"],"sources":["/home/kali/Desktop/c++/proshop/src/screens/ProductEditScreen.js"],"sourcesContent":["import axios from 'axios'\nimport React,{useState,useEffect} from 'react'\nimport {Link, redirect,useNavigate} from 'react-router-dom'\nimport {Form,Row,Col,Button, NavItem,File} from 'react-bootstrap'\nimport {useDispatch,useSelector} from 'react-redux'\nimport { useParams} from 'react-router'\nimport Loader from '../components/Loader'\nimport Message from '../components/Message'\nimport FormContainer from '../components/FormContainer'\nimport {listProductDetails,updateProduct} from '../actions/productActions'\nimport { PRODUCT_UPDATE_RESET } from '../constants/productConstants'\nconst ProductEditScreen = ({}) => {\n    const navigate=useNavigate()\n    const dispatch=useDispatch()\n    const {id}=useParams()\n    // console.log(id)\n    const [name,setName]=useState('')\n    const [price,setPrice]=useState('')\n    const [image,setImage]=useState('')\n    const [brand,setBrand]=useState('')\n    const [category,setCategory]=useState('')\n    const [countInStock,setCountInStock]=useState('')\n    const [description,setDescription]=useState('')\n    const [uploading,setUploading]=useState(false)\n    \n    \n    const productDetails=useSelector((state)=>state.productDetails)\n    const {loading,error,product}=productDetails\n    \n\n    const productUpdate=useSelector((state)=>state.productUpdate)\n    const {loading:loadingUpdate,error:errorUpdate,success:successUpdate}=productUpdate\n    // console.log(successUpdate)\n    useEffect(()=>{\n      if(successUpdate){\n        console.log('called')\n        dispatch({type:PRODUCT_UPDATE_RESET});\n        navigate('/admin/productlist');\n      }else{\n    if(!product.name || product._id!==id){\n      dispatch(listProductDetails(id))\n    }else\n    {\n\n      // console.log('this is st data')\n      // console.log(product.name)\n      setName(product.name)\n      setPrice(product.price)\n      setDescription(product.description)\n      setBrand(product.brand)\n      setCategory(product.category)\n      setCountInStock(product.countInStock)\n      setImage(product.image)  \n    }}\n    }\n    ,[dispatch,id,navigate,product,successUpdate])\n    \n    const handleChange=async (e)=>{\n      const file=e.target.files[0];\n      // setImage(e.target.files[0])\n      const formData=new FormData();\n      formData.append('image',file)\n      console.log(formData)\n      setUploading(true)\n      try{\n        const config={\n          headers:{\n            'Content-Type':'mutipart/form-data'\n          }\n        }\n        const {data}=await axios.post('/api/upload',formData,config)\n        setImage(data)\n        setUploading(false)\n      }catch(err){\n        console.log(err)\n         setUploading(false);\n\n      }\n    }\n    const submitHandler =(e)=>{\n      e.preventDefault()\n      dispatch(\n      updateProduct({\n        _id:id,\n        name,\n        price,\n        description,\n        image,\n        brand,\n        category,\n        countInStock,\n\n      })\n    )\n\n    }\n    const setPassword=()=>{\n      console.log('set password')\n    }\n  //   function handleChange(e) {\n  //     console.log(e.target.files);\n  //     setImage(URL.createObjectURL(e.target.files[0]));\n  // }\n  return (\n    <>\n    <Link to='/admin/productlist' className='btn btn-light my-3'>Go back</Link>\n    \n    <FormContainer>\n      <h1>Edit Product</h1>\n      {/* {loadingUpdate &&<Loader/>} */}\n      {errorUpdate && <Message variant='danger'>{errorUpdate}</Message>}\n      {loading?<Loader/>:error?<Message variant='danger'>{error}</Message>:\n      (\n        <Form onSubmit={submitHandler}>\n\n      <Form.Group controlId='name'>\n            <Form.Label>Name</Form.Label>\n            <Form.Control type='name' placeholder='Enter name'\n            value={name}\n            onChange={(e)=>setName(e.target.value)}\n            \n            ></Form.Control>\n        </Form.Group>\n\n        \n        <Form.Group controlId='price'>\n            <Form.Label>Price</Form.Label>\n            <Form.Control type='number' placeholder='Enter Price'\n            value={price}\n            onChange={(e)=>setPrice(e.target.value)}\n            \n            ></Form.Control>\n        </Form.Group>\n\n        {/* <Form.Group controlId='image'>\n            <Form.Control type='text'\n            placeholder='enter image url'\n            value={image}\n            onChange={(e)=>setImage(e.target.value)}\n            ></Form.Control>\n            <Form.File  id='image-file'label='choose file'\n            custom onChange={handleChange}>\n\n            </Form.File>\n            {uploading &&<Loader/>}\n      </Form.Group> */}\n\n\n        \n           <input type=\"file\" onChange={handleChange}  />\n            <img src={image} />\n             \n\n         \n        {uploading &&<Loader/>}\n        <Form.Group controlId='brand'>\n            <Form.Label>Brand </Form.Label>\n            <Form.Control type='text'label='Enter brand'\n            value={brand}\n            onChange={(e)=>setBrand(e.target.value)}\n            \n            ></Form.Control>\n\n        </Form.Group>\n\n        <Form.Group controlId='countInStock'>\n            <Form.Label>Count In Stock</Form.Label>\n            <Form.Control type='number' placeholder='Enter countInStock'\n            value={countInStock}\n            onChange={(e)=>setCountInStock(e.target.value)}\n            \n            ></Form.Control>\n        </Form.Group>\n\n\n        <Form.Group controlId='category'>\n            <Form.Label>Category </Form.Label>\n            <Form.Control type='text'label='Enter category'\n            value={category}    \n            onChange={(e)=>setCategory(e.target.value)}\n            \n            ></Form.Control>\n\n        </Form.Group>\n\n\n        <Form.Group controlId='description'>\n            <Form.Label>Description </Form.Label>\n            <Form.Control type='text'label='Enter description'\n            value={description}\n            onChange={(e)=>setDescription(e.target.value)}\n            \n            ></Form.Control>\n\n        </Form.Group>\n\n\n        <Button type='submit' variant='primary'>\n            submit\n        </Button>\n      </Form>\n\n\n      )}\n      \n      \n    </FormContainer>\n    </>\n  )\n}\n\nexport default ProductEditScreen\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}